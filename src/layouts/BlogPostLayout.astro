---
// src/layouts/BlogPostLayout.astro
import BaseLayout from './BaseLayout.astro';
import RelatedPosts from '../components/RelatedPosts.astro';

// â˜…â˜…â˜… æ–°å¢ï¼šå®šç¾©è³‡æ–™çµæ§‹ä»‹é¢ (Interface)ï¼Œè§£æ±º tag ç´…å­—å•é¡Œ â˜…â˜…â˜…
interface Props {
  frontmatter: {
    title: string;
    pubDate: string;
    tags?: string[]; // æ˜ç¢ºå‘Šè¨´ç¨‹å¼ tags æ˜¯ä¸€å€‹å­—ä¸²é™£åˆ—
    author?: string;
    image?: any;
    [key: string]: any; // å…è¨±å…¶ä»–ä»»æ„æ¬„ä½
  };
  url: string;
}

const { frontmatter, url } = Astro.props;
---

<BaseLayout pageTitle={frontmatter.title} frontmatter={frontmatter}>
  
  <article class="blog-post-container">
    
    {/* æ–‡ç« é ­éƒ¨ï¼šåˆ†é¡æ¨™ç±¤ã€æ¨™é¡Œã€æ—¥æœŸ */}
    <header class="post-header">
      {/* å› ç‚ºä¸Šé¢å®šç¾©äº† tags æ˜¯å­—ä¸²é™£åˆ—ï¼Œé€™è£¡çš„ tag å°±çŸ¥é“æ˜¯ string äº†ï¼Œä¸æœƒå†å ±ç´…å­— */}
      {frontmatter.tags && (
        <div class="tags">
          {frontmatter.tags.map((tag) => (
            <a href={`/tags/${tag}`} class="tag">#{tag}</a>
          ))}
        </div>
      )}
      
      <h1 class="post-title">{frontmatter.title}</h1>
      
      <div class="post-meta">
        <span class="date">
          ğŸ“… {new Date(frontmatter.pubDate).toLocaleDateString('zh-TW')}
        </span>
        {frontmatter.author && (
          <span class="author">ğŸ‘¤ {frontmatter.author}</span>
        )}
      </div>
    </header>

    {/* å°é¢åœ– */}
    {frontmatter.image && (
      <div class="post-cover">
        <img 
          src={frontmatter.image.url || frontmatter.image} 
          alt={frontmatter.image.alt || frontmatter.title} 
        />
      </div>
    )}

    {/* æ–‡ç« æ­£æ–‡ */}
    <div class="post-content prose">
      <slot />
    </div>

    {/* â˜…â˜…â˜… æ¨è–¦æ–‡ç« å€å¡Š (è‡ªå‹•æŠ“å–ç›¸é—œå…§å®¹) â˜…â˜…â˜… */}
    <RelatedPosts 
      currentTags={frontmatter.tags || []} 
      currentUrl={url} 
    />

  </article>

</BaseLayout>

<style>
  .blog-post-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .post-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .tags {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  .tag {
    background-color: #f3f4f6;
    color: #4b5563;
    padding: 0.2rem 0.8rem;
    border-radius: 999px;
    font-size: 0.85rem;
    text-decoration: none;
    transition: all 0.2s;
  }
  .tag:hover {
    background-color: #e0e7ff;
    color: #4f39fa;
  }

  .post-title {
    font-size: 2.5rem;
    color: #111;
    margin-bottom: 1rem;
    line-height: 1.3;
  }

  .post-meta {
    color: #666;
    font-size: 0.95rem;
    display: flex;
    justify-content: center;
    gap: 1.5rem;
  }

  .post-cover {
    margin-bottom: 3rem;
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }

  .post-cover img {
    width: 100%;
    height: auto;
    display: block;
  }

  /* ç°¡å–®çš„æ’ç‰ˆæ¨£å¼ï¼Œæ‚¨å¯ä»¥æ ¹æ“šéœ€è¦èª¿æ•´ */
  .post-content {
    line-height: 1.8;
    color: #333;
    font-size: 1.1rem;
  }
  
  /* è®“æ–‡ç« å…§çš„åœ–ç‰‡ä¹Ÿè‡ªé©æ‡‰ */
  .post-content :global(img) {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
  }

  @media (max-width: 768px) {
    .post-title { font-size: 1.8rem; }
  }

  .post-content :global(iframe) {
  width: 100%;           /* å¼·åˆ¶å¯¬åº¦è·Ÿéš¨æ‰‹æ©Ÿè¢å¹•ç¸®æ”¾ */
  max-width: 100%;
  aspect-ratio: 16 / 9;  /* é—œéµï¼è‡ªå‹•è¨ˆç®—é«˜åº¦ï¼Œä¿æŒ 16:9 å®Œç¾æ¯”ä¾‹ */
  height: auto;          
  border-radius: 8px;
  margin-bottom: 1.5rem;
}

* **:global(iframe)**ï¼šå› ç‚º `iframe` æ˜¯æ‚¨åœ¨ Markdown è£¡é¢å¯«çš„ HTMLï¼ŒAstro é è¨­æ¨£å¼æŠ“ä¸åˆ°å®ƒï¼Œæ‰€ä»¥è¦ç”¨ `:global`ã€‚
* **aspect-ratio: 16 / 9**ï¼šé€™æ˜¯ç¾ä»£ CSS çš„é­”æ³•å±¬æ€§ï¼Œå®ƒæœƒè‡ªå‹•ç¢ºä¿å½±ç‰‡ä¸ç®¡å¯¬åº¦è®Šå¤šå°‘ï¼Œé«˜åº¦éƒ½æœƒè‡ªå‹•èª¿æ•´æˆ 16:9ï¼Œä¸æœƒè®Šå½¢ä¹Ÿä¸æœƒç•™é»‘é‚Šã€‚
</style>